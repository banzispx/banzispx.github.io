
##[一个故事讲完https ](https://mp.weixin.qq.com/s/StqqafHePlBkWAPQZg3NrA)

### 对称加密算法

 我们会让有公信力的认证中心（简称CA）用它的私钥对消息摘要加密，形成签名：

 <img :src="$withBase('/http/jiami.png')" alt="jiami">

 这还不算， 还把原始信息和数据签名合并， 形成一个全新的东西，叫做“数字证书”

 <img :src="$withBase('/http/zhengshu.png')" alt="jiami">

 张大胖接着说：当Bill把他的证书发给我的时候， 我就用同样的Hash 算法， 再次生成消息摘要，然后用CA的公钥对数字签名解密， 得到CA创建的消息摘要， 两者一比，就知道有没有人篡改了！
如果没人篡改， 我就可以安全的拿到Bill的公钥喽，有了公钥， 后序的加密工作就可以开始了。
虽然很费劲， 但是为了防范你们这些偷窥者，实在是没办法啊。

 <img :src="$withBase('/http/jeixi.png')" alt="jiami">

 中间人恶狠狠地说： “算你小子狠！ 等着吧，我还有别的招。 对了，我且问你， 你这个CA的公钥怎么拿到？　难道不怕我在你传输ＣＡ公钥的时候发起中间人攻击吗？　如果我成功的伪装成了ＣＡ，你这一套体系彻底玩完。”


张大胖语塞了，折腾了半天，又回到了公钥安全传输的问题！


不过转念一想，想解决鸡生蛋，蛋生鸡的问题必须得打破这个怪圈才行，我必须得信任ＣＡ，并且通过安全的的方式获取他们的公钥，这样才能把游戏玩下去。


（公众号码农翻身注：这些ＣＡ本身也有证书来证明自己的身份，并且ＣＡ的信用是像树一样分级的，高层的ＣＡ给底层的ＣＡ做信用背书，而操作系统／浏览器中会内置一些顶层的ＣＡ的证书，相当于你自动信任了他们。　这些顶层的ＣＡ证书一定得安全地放入操作系统／浏览器当中，否则世界大乱。）


终于可以介绍https了，前面已经介绍了https的原理， 你把张大胖替换成浏览器， 把Bill 替换成某个网站就行了。


一个简化的（例如下图没有包含Pre-Master Secret）https流程图是这样的， 如果你理解了前面的原理，这张图就变得非常简单：

 <img :src="$withBase('/http/https.png')" alt="jiami">